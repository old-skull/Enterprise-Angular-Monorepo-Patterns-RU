# Применение политики единой версии

Google вводит ограничение на использование одной версии Angular во всех проектах. Наибольшая выгода для них заключается в том, что они могут тестировать новые версии Angular внутри компании для устранения проблем; однако есть и другие преимущества:

* Это облегчает совместное использование кода в организации. Наличие одинаковых версий зависимостей избавляет от необходимости проверять, будет ли работать уже существующий фрагмент кода при интеграции.
* Это гарантирует, что никакие уязвимости безопасности не останутся неисправленными.
* Это помогает разработчикам перемещаться между проектами.

Если мы также ведем разработку используя trunk-based (см. Часть 5 для обсуждения trunk-based разработки), это может иметь и некоторые отрицательные стороны.

* Обновление зависимых версий может потребовать больше усилий, если необходимо внести много изменений. Это можно немного облегчить, обеспечив регулярное обновление в организации (даже для незначительных или патч-версий). Большой разрыв в версиях повлечет за собой гораздо больше изменений.
* Это делает невозможным для определенного проекта использовать другую версию зависимости. Это затрудняет создание прототипов с использованием более новой версии зависимости (код не может быть объединен, пока это изменение не станет общеорганизационным).

Политика единой версии применяется к двум аспектам рабочего пространства:

1. Единый package.json: Зависимости, перечисленные в <mark style="color:red;">`package.json`</mark>, применяются ко всему рабочему пространству если имеется только один <mark style="color:red;">`package.json`</mark>.
2. Весь код библиотек в одном репозитории: код библиотек находится в одном репозитории, поэтому нет возможности иметь предыдущие версии кода, если только мы не обновляем целевую ветку.

Существуют альтернативы единой политике версий для двух описанных аспектов:

#### Единый package.json

Можно использовать рабочие пространства Lerna или yarn, чтобы иметь отдельный package.json для каждого приложения и управлять ими централизованно. Из-за накладных расходов на управление ими Nx не поддерживает несколько файлов package.json и предполагает, что в рабочем пространстве есть один файл package.json.

#### Весь код библиотек в одном репозитории

Можно использовать подмодули git для имитации различных версий библиотек (с каждой библиотекой в собственном репозитории). Nx будет работать при использовании подмодулей git, но это не рекомендуется из-за сложности, которую это вносит, и повышенной вероятности несовпадения SHA для подмодулей в рабочем пространстве.

Nx, будучи инструментом с собственной стратегией, предписывает единую политику версий, поскольку содержит один package.json и является единственным репозиторием (и не использует git-подмодули).
